<div class="container">
    <h1><a>Administration Panel</a></h1>
    <div class="background" style="background-color: #b3d9ff;">
        <div class="search-bar">
            <input class="form-control" type="text" name="search" [(ngModel)]="searchText" autocomplete="off" placeholder="search by book">
            <!-- <button class="w3-button w3-xlarge w3-circle w3-teal">+</button> -->
        </div>
        <br>
        <div class="btnAndTitle">
            <strong style="height: 100px;" class="btnTitle">ADD NEW</strong>
            <BR>
            <button class="createBookBtn" data-bs-toggle="modal" data-bs-target="#Modal_Create_Book">+</button>
        </div>
        <!-- <span *ngIf="message != ''">{{ message }}</span> -->
        <table style="width: 1000px; background-color: #686868;" class="table table-striped table table-hover table table-bordered">
            <thead>
                <tr class="head">
                    <!-- <th style="background-color: #212121; color: aliceblue; width: 20%;" *ngFor="let head of displayedColumns" scope="col">{{ head }} </th> -->
                    <th style="background-color: #212121; color: aliceblue; width: 0%;">Operation</th>
                    <th style="background-color: #212121; color: aliceblue; width: 9%;">Image</th>
                    <th style="background-color: #212121; color: aliceblue; width: 20%;">Title</th>
                    <th style="background-color: #212121; color: aliceblue; width: 20%;">Language</th>
                    <th style="background-color: #212121; color: aliceblue; width: 20%;">Description</th>
                    <th style="background-color: #212121; color: aliceblue; width: 0%;">Publishyear</th>
                </tr>
            </thead>
            <tbody *ngIf="books?.length != 0">
                <!-- | filter:searchText -->
                <tr class="head-values" *ngFor="let book of books | paginate: { itemsPerPage: 5, currentPage: p }">
                    <button style="width: 53px; height: 59px;" (click)="delete_book(book)"><i class="fa-solid fa-trash red-color" style="font-size: 20px;"></i></button>
                    <button style="width: 53px; height: 59px; color: rgb(224, 211, 22);" (click)="edit_book(book)" data-bs-toggle="modal" data-bs-target="#Modal_Book"><i class="fas fa-edit" style="font-size: 20px;"></i></button>
                    <td><img src="/assets/images/{{book.image}}" alt="picture of book" id="img"></td>
                    <td style="color: whitesmoke;">{{ book.title }}</td>
                    <td style="color: whitesmoke;">{{ book.language }}</td>
                    <td style="color: whitesmoke;">{{ book.description }}</td>
                    <td style="color: whitesmoke;">{{ book.publishYear }}</td>
                </tr>
                <pagination-controls (pageChange)="p = $event"></pagination-controls>
            </tbody>
            <tbody *ngIf="books?.length == 0">
                <tr>
                    <td colspan="3" class="no-data-available">Book Table Is Empty!</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>



<!-- Modal CREATE Book -->
<div class="modal fade" id="Modal_Create_Book" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger" id="exampleModalLabel">CREATE NEW BOOK</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="title" class="form-label">Title</label>
                        <input [(ngModel)]="book.title" type="text" class="form-control" id="title" name="title" placeholder="book title">
                    </div>
                    <div class="mb-3">
                        <label for="language" class="form-label">Language</label>
                        <input [(ngModel)]="book.language" type="text" class="form-control" id="language" name="language" placeholder="book language">
                    </div>
                    <div class="mb-3">
                        <label for="description" class="form-label">Description</label>
                        <input [(ngModel)]="book.description" type="text" class="form-control" id="description" name="description" placeholder="short book summary">
                    </div>
                    <div class="mb-3">
                        <label for="publishYear" class="form-label">Publish Year</label>
                        <input min="1900" max="2022" [(ngModel)]="book.publishYear" type="number" class="form-control" id="publishYear" name="publishYear">
                    </div>
                    <br>
                    <div *ngIf="authorId_value">
                        <label>Author: </label> &nbsp;
                        <input [(ngModel)]="author.firstName" [value]="author.firstName">
                    </div>
                    <div *ngIf="isShown_author">
                        <div *ngIf="author_dropdown">
                            <label>Author: </label> &nbsp;
                            <select [(ngModel)]="book.authorId" name="author">
                <option *ngFor="let author of authors" [value]="author.id">{{author.firstName}}</option>
              </select> &nbsp;
                            <button (click)="newAuthor()" type="button" class="btn btn-primary btn-sm" *ngIf="btn_new_author">new author</button>
                        </div>
                    </div>
                    <div class="author_form" *ngIf="isShown_author_form">
                        <input [(ngModel)]="author.firstName" type="text" class="form-control" id="firstName" name="firstName" placeholder="Firstname">
                        <br>
                        <input [(ngModel)]="author.middleName" type="text" class="form-control" id="middleName" name="middleName" placeholder="Middlename (optional)">
                        <br>
                        <input [(ngModel)]="author.lastName" type="text" class="form-control" id="lastName" name="lastName" placeholder="Lastname">
                        <br>
                        <button (click)="cancel_new_author()" type="button" class="btn btn-warning">Cancel</button> &nbsp; &nbsp;
                        <button (click)="ContinueAuthorForm()" class="btn btn-primary btn-sm">Continue</button>
                        <span *ngIf="message != ''">{{message}}</span>
                    </div>
                    <br>
                    <br>
                    <div *ngIf="publisherId_value">
                        <label>Publisher: </label> &nbsp;
                        <input [(ngModel)]="publisher.name" [value]="publisher.name" name="publisher">
                    </div>
                    <div *ngIf="isShown_publisher">
                        <div *ngIf="publisher_dropdown">
                            <label>Publisher: </label> &nbsp;
                            <select [(ngModel)]="book.publisherId" name="publisher" required>
                  <option *ngFor="let publisher of publishers" [value]="publisher.id">{{publisher.name}}</option>
              </select> &nbsp;
                            <button (click)="newPublisher()" type="button" class="btn btn-primary btn-sm" *ngIf="btn_new_publisher">new publisher</button>
                        </div>
                    </div>
                    <div class="publisher_form" *ngIf="isShown_publisher_form">
                        <input [(ngModel)]="publisher.name" type="text" class="form-control" id="name" name="name" placeholder="Publisher">
                        <br>
                        <button (click)="cancel_new_publisher()" type="button" class="btn btn-warning">Cancel</button> &nbsp; &nbsp;
                        <button (click)="ContinuePublisherForm()" class="btn btn-primary btn-sm">Continue</button>
                        <span *ngIf="message != ''">{{message}}</span>
                    </div>
                    <br>
                    <br>
                    <div *ngIf="isShown_category">
                        <label>Category: </label> &nbsp;
                        <select [(ngModel)]="book.categoryId" name="category">
            <option *ngFor="let category of categorys" [value]="category.id">{{category.categoryName}}</option>
          </select>
                    </div>
                    <br>
                    <br>
                    <div *ngIf="isShown_image">
                        <label>Image: </label> &nbsp;
                        <select [(ngModel)]="book.image" name="image">
              <option [ngValue]="null" selected disabled>Select Image</option>
              <option *ngFor="let img of imageArray" [ngValue]="img.name.toString()">{{img.name}}</option>
            </select>
                    </div>
                    <br>
                    <br>
                    <button (click)="save_book()" type="button" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
                </form>
            </div>
            <div class="modal-footer">
                <button (click)="cancel()" type="button" class="btn btn-warning" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<!-- Modal UPDATE Book -->
<div class="modal fade" id="Modal_Book" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger" id="exampleModalLabel">EDIT BOOK DETAILS</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <!-- <label for="title" class="form-label">Title</label> -->
                        <input [(ngModel)]="book.title" type="text" class="form-control" id="title" name="title">
                    </div>
                    <div class="mb-3">
                        <!-- <label for="language" class="form-label">language</label> -->
                        <input [(ngModel)]="book.language" type="text" class="form-control" id="language" name="language">
                    </div>
                    <div class="mb-3">
                        <!-- <label for="description" class="form-label">Description</label> -->
                        <input [(ngModel)]="book.description" type="text" class="form-control" id="description" name="description">
                    </div>
                    <div class="mb-3">
                        <!-- <label for="publishYear" class="form-label">publishYear</label> -->
                        <input [(ngModel)]="book.publishYear" type="text" class="form-control" id="publishYear" name="publishYear">
                    </div>

                    &nbsp;&nbsp;
                    <button (click)="save_book()" type="button" class="btn btn-primary" data-bs-dismiss="modal">Save</button>
                </form>
            </div>
            <div class="modal-footer">
                <button (click)="cancel()" type="button" class="btn btn-warning" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
